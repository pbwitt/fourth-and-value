<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NHL Totals - Fourth & Value</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      background: #0f0f0f;
      color: #fff;
      line-height: 1.6;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem 1rem;
    }

    /* Header */
    .header {
      margin-bottom: 2rem;
    }
    h1 {
      font-size: 2rem;
      margin-bottom: 0.5rem;
      color: #4FC3F7;
    }
    .subtitle {
      color: #999;
      margin-bottom: 1rem;
    }

    /* Tabs */
    .tabs {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 2rem;
      border-bottom: 2px solid #2a2a2a;
    }
    .tab {
      padding: 0.75rem 1.5rem;
      background: transparent;
      color: #999;
      text-decoration: none;
      border-bottom: 3px solid transparent;
      transition: all 0.2s;
    }
    .tab:hover {
      color: #fff;
    }
    .tab.active {
      color: #4FC3F7;
      border-bottom-color: #4FC3F7;
    }

    /* Filters */
    .filters {
      background: #2a2a2a;
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 1.5rem;
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      align-items: center;
    }
    .filter-group {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
    }
    .filter-group label {
      font-size: 0.875rem;
      color: #999;
    }
    .search-box {
      padding: 0.5rem;
      background: #1a1a1a;
      border: 1px solid #444;
      border-radius: 4px;
      color: #fff;
      font-size: 0.875rem;
      min-width: 250px;
    }
    .search-box:focus {
      outline: none;
      border-color: #4FC3F7;
    }
    .search-box::placeholder {
      color: #666;
    }

    /* Multi-select book dropdown */
    .checkbox-dropdown { position: relative; min-width: 180px; }
    .checkbox-dropdown-button { width: 100%; background: #1a1a1a; color: #fff; border: 1px solid #444; border-radius: 4px; padding: 10px 12px; outline: none; cursor: pointer; text-align: left; display: flex; justify-content: space-between; align-items: center; font-size: 0.875rem; }
    .checkbox-dropdown-button:hover { border-color: #4FC3F7; }
    .checkbox-dropdown-button::after { content: 'â–¼'; font-size: 10px; opacity: 0.6; }
    .checkbox-dropdown.open .checkbox-dropdown-button::after { content: 'â–²'; }
    .checkbox-group { display: none; position: absolute; z-index: 1000; flex-direction: column; gap: 6px; background: #1a1a1a; border: 1px solid #444; border-radius: 4px; padding: 10px; max-height: 250px; overflow-y: auto; min-width: 100%; margin-top: 4px; box-shadow: 0 4px 12px rgba(0,0,0,.3); }
    .checkbox-dropdown.open .checkbox-group { display: flex; }
    .checkbox-item { display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 4px 6px; border-radius: 6px; transition: background .15s; }
    .checkbox-item:hover { background: rgba(255,255,255,.05); }
    .checkbox-item input[type="checkbox"] { width: 16px; height: 16px; cursor: pointer; accent-color: #4FC3F7; }
    .checkbox-item label { cursor: pointer; flex: 1; font-size: 13px; color: #fff; margin: 0; white-space: nowrap; }

    /* Stats summary */
    .stats-summary {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin-bottom: 2rem;
    }
    .stat-card {
      background: #1a1a1a;
      padding: 1.5rem;
      border-radius: 8px;
      border: 1px solid #2a2a2a;
    }
    .stat-label {
      font-size: 0.875rem;
      color: #999;
      margin-bottom: 0.5rem;
    }
    .stat-value {
      font-size: 1.75rem;
      font-weight: bold;
      color: #4FC3F7;
    }

    /* Edge plays section */
    .edge-plays {
      background: #1a1a1a;
      border: 2px solid #4FC3F7;
      border-radius: 8px;
      padding: 1.5rem;
      margin-bottom: 2rem;
    }
    .edge-plays h2 {
      color: #4FC3F7;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .edge-plays h2::before {
      content: "ðŸŽ¯";
    }

    /* Game cards */
    .games-grid {
      display: grid;
      gap: 1rem;
    }
    .game-card {
      background: #1a1a1a;
      border: 1px solid #2a2a2a;
      border-radius: 8px;
      padding: 1.5rem;
      transition: border-color 0.2s;
    }
    .game-card:hover {
      border-color: #4FC3F7;
    }
    .game-card.has-edge {
      border: 2px solid #4FC3F7;
      background: linear-gradient(135deg, #1a1a1a 0%, #1a2a3a 100%);
    }

    .game-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid #2a2a2a;
    }
    .matchup {
      font-size: 1.25rem;
      font-weight: bold;
    }

    .totals-row {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 0.75rem;
      margin-bottom: 1rem;
    }
    .total-item {
      background: #2a2a2a;
      padding: 0.75rem;
      border-radius: 4px;
    }
    .total-label {
      font-size: 0.75rem;
      color: #999;
      margin-bottom: 0.25rem;
    }
    .total-value {
      font-size: 1.25rem;
      font-weight: bold;
    }
    .total-value.model {
      color: #4FC3F7;
    }
    .total-value.market {
      color: #FFA726;
    }
    .total-value.edge {
      color: #66BB6A;
    }

    /* Book lines table */
    .book-lines {
      margin-top: 1rem;
      background: #2a2a2a;
      border-radius: 4px;
      padding: 1rem;
    }
    .book-lines h4 {
      font-size: 0.875rem;
      color: #4FC3F7;
      margin-bottom: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .book-lines-table {
      width: 100%;
      border-collapse: collapse;
    }
    .book-lines-table th {
      text-align: left;
      font-size: 0.75rem;
      color: #999;
      padding: 0.5rem;
      border-bottom: 1px solid #3a3a3a;
    }
    .book-lines-table td {
      padding: 0.5rem;
      font-size: 0.875rem;
      border-bottom: 1px solid #222;
    }
    .book-lines-table tr:last-child td {
      border-bottom: none;
    }
    .book-lines-table tr:hover {
      background: #333;
    }
    .consensus-row {
      background: #1a2a1a !important;
      font-weight: bold;
    }
    .consensus-row td {
      color: #66BB6A;
    }

    /* Edge plays in card */
    .edge-play-list {
      background: #2a2a2a;
      border-radius: 4px;
      padding: 1rem;
      margin-top: 1rem;
    }
    .edge-play-item {
      padding: 0.75rem;
      background: #1a1a1a;
      border-left: 3px solid #4FC3F7;
      margin-bottom: 0.75rem;
      border-radius: 4px;
    }
    .edge-play-item:last-child {
      margin-bottom: 0;
    }
    .play-bet {
      font-size: 1.125rem;
      font-weight: bold;
      color: #4FC3F7;
      margin-bottom: 0.5rem;
    }
    .play-details {
      font-size: 0.875rem;
      color: #999;
    }

    .no-data {
      text-align: center;
      padding: 3rem;
      color: #999;
    }

    .updated {
      text-align: center;
      color: #666;
      font-size: 0.875rem;
      margin-top: 2rem;
    }
  </style>
</head>
<body>
  <div id="nav-root"></div>

  <div class="container">
    <div class="header">
      <h1>NHL Totals</h1>
      <p class="subtitle">Model predictions vs market consensus â€¢ Find outlier books before lines move</p>
    </div>

    <div class="tabs">
      <a href="../../nhl/props/index.html" class="tab">Props</a>
      <a href="../../nhl/totals/index.html" class="tab active">Totals</a>
    </div>

    <div class="filters">
      <div class="filter-group">
        <label>Game</label>
        <input type="text" id="gameSearch" class="search-box" placeholder="Filter by team (e.g., TOR, BOS)..." />
      </div>

      <div class="filter-group">
        <label>Book</label>
        <div id="bookDropdown" class="checkbox-dropdown">
          <button type="button" id="bookButton" class="checkbox-dropdown-button">
            <span id="bookButtonText">All Books</span>
          </button>
          <div id="bookFilter" class="checkbox-group"></div>
        </div>
      </div>
    </div>

    <div class="stats-summary">
      <div class="stat-card">
        <div class="stat-label">Games Today</div>
        <div class="stat-value">52</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Consensus Edges</div>
        <div class="stat-value">0</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Avg Model Total</div>
        <div class="stat-value">6.1</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Avg Market Total</div>
        <div class="stat-value">nan</div>
      </div>
    </div>

    <div id="gamesContainer"></div>

    <div class="updated">
      Last updated: 2025-11-09 12:31 PM ET
    </div>
  </div>

  <script>
    const gamesData = [
  {
    "home_team": "DET",
    "away_team": "CHI",
    "matchup": "CHI @ DET",
    "model_total": 5.75,
    "home_pred": 1.36,
    "away_pred": 4.39,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "PIT",
    "away_team": "LAK",
    "matchup": "LAK @ PIT",
    "model_total": 3.02,
    "home_pred": 1.12,
    "away_pred": 1.9,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "TOR",
    "away_team": "CAR",
    "matchup": "CAR @ TOR",
    "model_total": 8.46,
    "home_pred": 3.02,
    "away_pred": 5.44,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "OTT",
    "away_team": "UTA",
    "matchup": "UTA @ OTT",
    "model_total": 5.45,
    "home_pred": 3.58,
    "away_pred": 1.87,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "DAL",
    "away_team": "SEA",
    "matchup": "SEA @ DAL",
    "model_total": 9.01,
    "home_pred": 5.32,
    "away_pred": 3.7,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "MIN",
    "away_team": "CGY",
    "matchup": "CGY @ MIN",
    "model_total": 4.76,
    "home_pred": 4.57,
    "away_pred": 0.2,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "VAN",
    "away_team": "COL",
    "matchup": "COL @ VAN",
    "model_total": 12.56,
    "home_pred": 4.12,
    "away_pred": 8.44,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "ANA",
    "away_team": "WPG",
    "matchup": "WPG @ ANA",
    "model_total": 4.16,
    "home_pred": 3.39,
    "away_pred": 0.77,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "NJD",
    "away_team": "NYI",
    "matchup": "NYI @ NJD",
    "model_total": 7.23,
    "home_pred": 1.11,
    "away_pred": 6.11,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "NYR",
    "away_team": "NSH",
    "matchup": "NSH @ NYR",
    "model_total": 3.36,
    "home_pred": 0.12,
    "away_pred": 3.23,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "EDM",
    "away_team": "CBJ",
    "matchup": "CBJ @ EDM",
    "model_total": 4.0,
    "home_pred": 0.61,
    "away_pred": 3.39,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "VGK",
    "away_team": "FLA",
    "matchup": "FLA @ VGK",
    "model_total": 4.04,
    "home_pred": 2.5,
    "away_pred": 1.54,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "BOS",
    "away_team": "TOR",
    "matchup": "TOR @ BOS",
    "model_total": 7.81,
    "home_pred": 4.84,
    "away_pred": 2.97,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "MTL",
    "away_team": "LAK",
    "matchup": "LAK @ MTL",
    "model_total": 7.56,
    "home_pred": 5.65,
    "away_pred": 1.9,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "OTT",
    "away_team": "DAL",
    "matchup": "DAL @ OTT",
    "model_total": 8.85,
    "home_pred": 3.58,
    "away_pred": 5.27,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "CAR",
    "away_team": "WSH",
    "matchup": "WSH @ CAR",
    "model_total": 7.13,
    "home_pred": 5.49,
    "away_pred": 1.64,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "STL",
    "away_team": "CGY",
    "matchup": "CGY @ STL",
    "model_total": 2.96,
    "home_pred": 2.77,
    "away_pred": 0.2,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "MIN",
    "away_team": "SJS",
    "matchup": "SJS @ MIN",
    "model_total": 7.8,
    "home_pred": 4.57,
    "away_pred": 3.24,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "COL",
    "away_team": "ANA",
    "matchup": "ANA @ COL",
    "model_total": 11.83,
    "home_pred": 8.49,
    "away_pred": 3.34,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "VAN",
    "away_team": "WPG",
    "matchup": "WPG @ VAN",
    "model_total": 4.89,
    "home_pred": 4.12,
    "away_pred": 0.77,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "SEA",
    "away_team": "CBJ",
    "matchup": "CBJ @ SEA",
    "model_total": 7.13,
    "home_pred": 3.74,
    "away_pred": 3.39,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "TBL",
    "away_team": "NYR",
    "matchup": "NYR @ TBL",
    "model_total": 2.78,
    "home_pred": 2.7,
    "away_pred": 0.07,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "PHI",
    "away_team": "EDM",
    "matchup": "EDM @ PHI",
    "model_total": 2.95,
    "home_pred": 2.4,
    "away_pred": 0.56,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "UTA",
    "away_team": "BUF",
    "matchup": "BUF @ UTA",
    "model_total": 4.06,
    "home_pred": 1.92,
    "away_pred": 2.14,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "CHI",
    "away_team": "NJD",
    "matchup": "NJD @ CHI",
    "model_total": 5.51,
    "home_pred": 4.44,
    "away_pred": 1.06,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "TOR",
    "away_team": "LAK",
    "matchup": "LAK @ TOR",
    "model_total": 4.92,
    "home_pred": 3.02,
    "away_pred": 1.9,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "MTL",
    "away_team": "DAL",
    "matchup": "DAL @ MTL",
    "model_total": 10.92,
    "home_pred": 5.65,
    "away_pred": 5.27,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "OTT",
    "away_team": "BOS",
    "matchup": "BOS @ OTT",
    "model_total": 8.37,
    "home_pred": 3.58,
    "away_pred": 4.79,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "DET",
    "away_team": "ANA",
    "matchup": "ANA @ DET",
    "model_total": 4.7,
    "home_pred": 1.36,
    "away_pred": 3.34,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "FLA",
    "away_team": "WSH",
    "matchup": "WSH @ FLA",
    "model_total": 3.23,
    "home_pred": 1.59,
    "away_pred": 1.64,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "CBJ",
    "away_team": "EDM",
    "matchup": "EDM @ CBJ",
    "model_total": 4.0,
    "home_pred": 3.44,
    "away_pred": 0.56,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "COL",
    "away_team": "BUF",
    "matchup": "BUF @ COL",
    "model_total": 10.63,
    "home_pred": 8.49,
    "away_pred": 2.14,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "CGY",
    "away_team": "SJS",
    "matchup": "SJS @ CGY",
    "model_total": 3.48,
    "home_pred": 0.24,
    "away_pred": 3.24,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "VGK",
    "away_team": "NYI",
    "matchup": "NYI @ VGK",
    "model_total": 8.61,
    "home_pred": 2.5,
    "away_pred": 6.11,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "SEA",
    "away_team": "WPG",
    "matchup": "WPG @ SEA",
    "model_total": 4.51,
    "home_pred": 3.74,
    "away_pred": 0.77,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "NSH",
    "away_team": "PIT",
    "matchup": "PIT @ NSH",
    "model_total": 4.35,
    "home_pred": 3.28,
    "away_pred": 1.07,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "CAR",
    "away_team": "VAN",
    "matchup": "VAN @ CAR",
    "model_total": 9.56,
    "home_pred": 5.49,
    "away_pred": 4.07,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "STL",
    "away_team": "PHI",
    "matchup": "PHI @ STL",
    "model_total": 5.12,
    "home_pred": 2.77,
    "away_pred": 2.35,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "UTA",
    "away_team": "NYI",
    "matchup": "NYI @ UTA",
    "model_total": 8.03,
    "home_pred": 1.92,
    "away_pred": 6.11,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "FLA",
    "away_team": "TBL",
    "matchup": "TBL @ FLA",
    "model_total": 4.24,
    "home_pred": 1.59,
    "away_pred": 2.66,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "MIN",
    "away_team": "ANA",
    "matchup": "ANA @ MIN",
    "model_total": 7.91,
    "home_pred": 4.57,
    "away_pred": 3.34,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "MTL",
    "away_team": "BOS",
    "matchup": "BOS @ MTL",
    "model_total": 10.45,
    "home_pred": 5.65,
    "away_pred": 4.79,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "OTT",
    "away_team": "LAK",
    "matchup": "LAK @ OTT",
    "model_total": 5.48,
    "home_pred": 3.58,
    "away_pred": 1.9,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "DET",
    "away_team": "BUF",
    "matchup": "BUF @ DET",
    "model_total": 3.5,
    "home_pred": 1.36,
    "away_pred": 2.14,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "WSH",
    "away_team": "NJD",
    "matchup": "NJD @ WSH",
    "model_total": 2.75,
    "home_pred": 1.69,
    "away_pred": 1.06,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "CAR",
    "away_team": "EDM",
    "matchup": "EDM @ CAR",
    "model_total": 6.04,
    "home_pred": 5.49,
    "away_pred": 0.56,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "CBJ",
    "away_team": "NYR",
    "matchup": "NYR @ CBJ",
    "model_total": 3.51,
    "home_pred": 3.44,
    "away_pred": 0.07,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "CHI",
    "away_team": "TOR",
    "matchup": "TOR @ CHI",
    "model_total": 7.41,
    "home_pred": 4.44,
    "away_pred": 2.97,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "STL",
    "away_team": "VGK",
    "matchup": "VGK @ STL",
    "model_total": 5.22,
    "home_pred": 2.77,
    "away_pred": 2.45,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "DAL",
    "away_team": "PHI",
    "matchup": "PHI @ DAL",
    "model_total": 7.66,
    "home_pred": 5.32,
    "away_pred": 2.35,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "CGY",
    "away_team": "WPG",
    "matchup": "WPG @ CGY",
    "model_total": 1.01,
    "home_pred": 0.24,
    "away_pred": 0.77,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  },
  {
    "home_team": "SEA",
    "away_team": "SJS",
    "matchup": "SJS @ SEA",
    "model_total": 6.98,
    "home_pred": 3.74,
    "away_pred": 3.24,
    "consensus_line": null,
    "median_line": null,
    "edge": null,
    "book_lines": [],
    "edge_plays": [],
    "has_edge": false
  }
];

    // State
    const state = {
      selectedBooks: new Set(),
      gameSearch: ''
    };

    // Get all unique books
    const allBooks = new Set();
    gamesData.forEach(game => {
      game.book_lines.forEach(line => allBooks.add(line.book_name));
    });

    // Initialize filters
    function initFilters() {
      // Populate book filter
      const bookGroup = document.getElementById('bookFilter');
      Array.from(allBooks).sort().forEach(book => {
        const div = document.createElement('div');
        div.className = 'checkbox-item';

        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.id = `book-${book}`;
        checkbox.value = book;
        checkbox.checked = true;
        state.selectedBooks.add(book);

        checkbox.addEventListener('change', e => {
          if (e.target.checked) {
            state.selectedBooks.add(book);
          } else {
            state.selectedBooks.delete(book);
          }
          updateBookButtonText();
          renderGames();
        });

        const label = document.createElement('label');
        label.htmlFor = `book-${book}`;
        label.textContent = book;

        div.appendChild(checkbox);
        div.appendChild(label);
        bookGroup.appendChild(div);
      });

      updateBookButtonText();

      // Book dropdown toggle
      const bookDropdown = document.getElementById('bookDropdown');
      const bookButton = document.getElementById('bookButton');

      bookButton.addEventListener('click', e => {
        e.stopPropagation();
        bookDropdown.classList.toggle('open');
      });

      document.addEventListener('click', e => {
        if (!bookDropdown.contains(e.target)) {
          bookDropdown.classList.remove('open');
        }
      });

      // Game search
      document.getElementById('gameSearch').addEventListener('input', e => {
        state.gameSearch = e.target.value.toLowerCase();
        renderGames();
      });
    }

    function updateBookButtonText() {
      const buttonText = document.getElementById('bookButtonText');
      const totalBooks = allBooks.size;

      if (state.selectedBooks.size === 0) {
        buttonText.textContent = 'No Books Selected';
      } else if (state.selectedBooks.size === totalBooks) {
        buttonText.textContent = 'All Books';
      } else {
        buttonText.textContent = `${state.selectedBooks.size} Books`;
      }
    }

    function renderGames() {
      const container = document.getElementById('gamesContainer');

      // Filter games by search
      const filtered = gamesData.filter(game => {
        if (state.gameSearch) {
          return game.matchup.toLowerCase().includes(state.gameSearch) ||
                 game.home_team.toLowerCase().includes(state.gameSearch) ||
                 game.away_team.toLowerCase().includes(state.gameSearch);
        }
        return true;
      });

      if (filtered.length === 0) {
        container.innerHTML = `
          <div class="no-data">
            <h3>No games match your filters</h3>
            <p>Try adjusting your search</p>
          </div>
        `;
        return;
      }

      container.innerHTML = '<div class="games-grid">' + filtered.map(game => {
        const cardClass = game.has_edge ? 'game-card has-edge' : 'game-card';

        // Filter book lines by selected books
        const visibleBookLines = game.book_lines.filter(line => state.selectedBooks.has(line.book_name));

        let html = `
          <div class="${cardClass}">
            <div class="game-header">
              <div class="matchup">${game.matchup}</div>
            </div>

            <div class="totals-row">
              <div class="total-item">
                <div class="total-label">Model Total</div>
                <div class="total-value model">${game.model_total.toFixed(1)}</div>
              </div>
              <div class="total-item">
                <div class="total-label">Home (${game.home_team})</div>
                <div class="total-value">${game.home_pred.toFixed(1)}</div>
              </div>
              <div class="total-item">
                <div class="total-label">Away (${game.away_team})</div>
                <div class="total-value">${game.away_pred.toFixed(1)}</div>
              </div>`;

        if (game.consensus_line) {
          html += `
              <div class="total-item">
                <div class="total-label">Market Consensus</div>
                <div class="total-value market">${game.consensus_line.toFixed(1)}</div>
              </div>`;
        }

        if (game.median_line) {
          html += `
              <div class="total-item">
                <div class="total-label">Median Line</div>
                <div class="total-value">${game.median_line.toFixed(1)}</div>
              </div>`;
        }

        if (game.edge !== null) {
          const edgeClass = Math.abs(game.edge) > 0.3 ? 'edge' : '';
          html += `
              <div class="total-item">
                <div class="total-label">Model Edge</div>
                <div class="total-value ${edgeClass}">${game.edge >= 0 ? '+' : ''}${game.edge.toFixed(1)}</div>
              </div>`;
        }

        html += '</div>';

        // Show edge plays
        if (game.edge_plays.length > 0) {
          html += '<div class="edge-play-list">';
          html += '<div style="font-size: 0.875rem; color: #4FC3F7; margin-bottom: 0.5rem; font-weight: bold;">ðŸŽ¯ Consensus Edge Plays:</div>';
          game.edge_plays.forEach(play => {
            const bet_emoji = play.bet === 'UNDER' ? 'ðŸ“‰' : 'ðŸ“ˆ';
            html += `
              <div style="margin-bottom: 0.5rem; padding: 0.5rem; background: #0f0f0f; border-radius: 4px;">
                <div style="color: #4FC3F7; font-weight: bold;">${bet_emoji} ${play.bet} ${play.line} at ${play.book} (${play.under_price >= 0 ? '+' : ''}${play.under_price})</div>
                <div style="font-size: 0.8rem; color: #999;">Consensus: ${play.consensus.toFixed(1)} | Model: ${play.model.toFixed(1)} | Edge: ${play.edge.toFixed(1)} goals</div>
              </div>
            `;
          });
          html += '</div>';
        }

        // Show book lines table
        if (visibleBookLines.length > 0) {
          html += `
            <div class="book-lines">
              <h4>ðŸ“Š All Book Lines</h4>
              <table class="book-lines-table">
                <thead>
                  <tr>
                    <th>Book</th>
                    <th>Total</th>
                    <th>Over</th>
                    <th>Under</th>
                    <th>Spread</th>
                    <th>Fav</th>
                    <th>Dog</th>
                  </tr>
                </thead>
                <tbody>`;

          // Add consensus row first if available
          if (game.consensus_line) {
            html += `
                  <tr class="consensus-row">
                    <td><strong>CONSENSUS</strong></td>
                    <td>${game.consensus_line.toFixed(1)}</td>
                    <td>â€”</td>
                    <td>â€”</td>
                    <td>â€”</td>
                    <td>â€”</td>
                    <td>â€”</td>
                  </tr>`;
          }

          // Add book lines
          visibleBookLines.forEach(line => {
            const totalLine = line.total_line || '-';
            const overPrice = line.over_price ? (line.over_price >= 0 ? '+' : '') + line.over_price : '-';
            const underPrice = line.under_price ? (line.under_price >= 0 ? '+' : '') + line.under_price : '-';
            const spread = line.spread || '-';
            const favPrice = line.spread_fav_price ? (line.spread_fav_price >= 0 ? '+' : '') + line.spread_fav_price : '-';
            const dogPrice = line.spread_dog_price ? (line.spread_dog_price >= 0 ? '+' : '') + line.spread_dog_price : '-';

            html += `
                  <tr>
                    <td>${line.book_name}</td>
                    <td>${totalLine}</td>
                    <td>${overPrice}</td>
                    <td>${underPrice}</td>
                    <td>${spread}</td>
                    <td>${favPrice}</td>
                    <td>${dogPrice}</td>
                  </tr>`;
          });

          html += `
                </tbody>
              </table>
            </div>`;
        }

        html += '</div>';
        return html;
      }).join('') + '</div>';
    }

    // Initialize
    initFilters();
    renderGames();
  </script>
  <script src="../../nav.js?v=30"></script>
</body>
</html>
